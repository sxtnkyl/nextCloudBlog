(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[243],{7146:function(e,t,n){"use strict";n.d(t,{xl:function(){return r},aA:function(){return o},zu:function(){return a}});var r="\n  query GetPost($id: ID!) {\n    getPost(id: $id) {\n      id\n      title\n      content\n      username\n      coverImage\n      createdAt\n      updatedAt\n    }\n  }\n",o="\n  query ListPosts(\n    $filter: ModelPostFilterInput\n    $limit: Int\n    $nextToken: String\n  ) {\n    listPosts(filter: $filter, limit: $limit, nextToken: $nextToken) {\n      items {\n        id\n        title\n        content\n        username\n        coverImage\n        createdAt\n        updatedAt\n      }\n      nextToken\n    }\n  }\n",a="\n  query PostsByUsername(\n    $username: String\n    $sortDirection: ModelSortDirection\n    $filter: ModelPostFilterInput\n    $limit: Int\n    $nextToken: String\n  ) {\n    postsByUsername(\n      username: $username\n      sortDirection: $sortDirection\n      filter: $filter\n      limit: $limit\n      nextToken: $nextToken\n    ) {\n      items {\n        id\n        title\n        content\n        username\n        coverImage\n        createdAt\n        updatedAt\n      }\n      nextToken\n    }\n  }\n"},1655:function(e,t,n){"use strict";n.r(t);var r=n(5893),o=n(6156),a=n(7757),i=n.n(a),s=n(2137),u=n(7294),c=n(5152),l=(n(5987),n(5112)),p=n(2786),f=n(4586),d=n(1163),m=(n(5675),n(7292)),b=n(7146);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=(0,c.default)((function(){return Promise.all([n.e(3126),n.e(1634),n.e(2562)]).then(n.bind(n,1634))}),{ssr:!1,loadableGenerated:{webpack:function(){return[1634]},modules:["edit-post\\[id].js -> react-simplemde-editor"]}});t.default=function(){var e=(0,u.useState)(null),t=e[0],n=e[1],a=(0,d.useRouter)(),c=a.query.id,g=(0,u.useState)(null),y=g[0],v=g[1],k=(0,u.useState)(null),w=k[0],O=k[1],P=(0,u.useRef)(null);if((0,u.useEffect)((function(){function e(){return(e=(0,s.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,l.b.graphql({query:b.xl,variables:{id:c}});case 4:t=e.sent,console.log("postData: ",t),n(t.data.getPost),t.data.getPost.coverImage&&j(t.data.getPost.coverImage);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[c]),!t)return null;function j(e){return $.apply(this,arguments)}function $(){return($=(0,s.Z)(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.Ke.get(t);case 2:n=e.sent,v(n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return(_=(0,s.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:P.current.click();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I=t.title,N=t.content;function T(){return(T=(0,s.Z)(i().mark((function e(){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I&&N){e.next=2;break}return e.abrupt("return");case 2:if(t={id:c,content:N,title:I},!y||!w){e.next=8;break}return n="".concat(y.name,"_").concat((0,f.Z)()),t.coverImage=n,e.next=8,p.Ke.put(n,y);case 8:return e.prev=8,e.next=11,l.b.graphql({query:m.CP,variables:{input:t},authMode:"AMAZON_COGNITO_USER_POOLS"});case 11:e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(8),a.push("/"),e.abrupt("return");case 17:console.log("post successfully updated!"),a.push("/my-posts");case 19:case"end":return e.stop()}}),e,null,[[8,13]])})))).apply(this,arguments)}return(0,r.jsxs)("div",{className:"container mx-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-semibold tracking-wide mt-6 mb-2",children:"Edit post"}),y&&(0,r.jsx)("img",{src:w||y,alt:"userImage",className:"mt-4"}),(0,r.jsx)("input",{onChange:function(e){n((function(){return h(h({},t),{},(0,o.Z)({},e.target.name,e.target.value))}))},name:"title",placeholder:"Title",value:t.title,className:"border-b pb-2 text-lg my-4 focus:outline-none w-full font-light text-gray-500 placeholder-gray-500 y-2"}),(0,r.jsx)(x,{value:t.content,onChange:function(e){return n(h(h({},t),{},{content:e}))}}),(0,r.jsx)("input",{type:"file",ref:P,className:"absolute w-0 h-0",onChange:function(e){var t=e.target.files[0];t&&(v(t),O(URL.createObjectURL(t)))}}),(0,r.jsx)("button",{className:"bg-purple-600 text-white font-semibold px-8 py-2 rounded-lg mr-2",onClick:function(){return _.apply(this,arguments)},children:"Upload Cover Image"}),(0,r.jsx)("button",{className:"mb-4 bg-blue-600 text-white font-semibold px-8 py-2 rounded-lg",onClick:function(){return T.apply(this,arguments)},children:"Update Post"})]})}},9537:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/edit-post/[id]",function(){return n(1655)}])}},function(e){e.O(0,[9774,4708,9351,8764,3935,5675,9508,2888,179],(function(){return t=9537,e(e.s=t);var t}));var t=e.O();_N_E=t}]);